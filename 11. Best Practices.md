## ðŸŽ¨ Chapter 11: Go Idioms and Best Practices

Go promotes a set of conventions that lead to code that is easy to read, maintain, and contribute to. Following these idioms is essential for writing **"Go-like"** code.

### 1. Naming Conventions

Go heavily prioritizes clarity and brevity in naming.

|**Rule**|**Example**|**Bad Example**|**Rationale**|
|---|---|---|---|
|**Brevity**|`i` for loop index, `r` for _request_, `w` for _writer_|`index`, `httpRequest`, `dataWriter`|Shorter names are common, especially for local variables.|
|**`Context`**|Pass `ctx context.Context` as the _first_ argument.|Pass `ctx` anywhere else.|This is a universal pattern for cancellation and deadlines.|
|**Exporting**|`GetConfig`, `ErrNotFound`|`get_config`, `err_not_found`|Use **camelCase** for local names and **PascalCase** for exported (public) names.|

### 2. Error Handling is Paramount

Avoid burying errors. Always check and handle errors immediately.

**Idiomatic:**

Go

```
f, err := os.Open(path)
if err != nil {
    // Handle or return the error immediately
    return nil, fmt.Errorf("could not open file: %w", err) 
}
defer f.Close()
// Proceed with file usage...
```

**Anti-Pattern:**

Go

```
f, err := os.Open(path)
// Don't defer error checking!
// A simple 'if err != nil' check is required first.
defer f.Close() 
```

**ðŸ”¥ Error Wrapping:** Use `%w` with `fmt.Errorf` (introduced in Go 1.13) to wrap errors. This preserves the original error while adding context, allowing callers to inspect the error chain.

### 3. Struct Tags

Struct fields can have optional string literal tags. These are commonly used to provide metadata for serialization/deserialization (JSON, XML, databases).

Go

```
type User struct {
    ID     int    `json:"id"`
    Name   string `json:"user_name"`
    Hidden string `json:"-"` // The '-' tag ignores the field in JSON
}
```

When encoding to JSON, the `ID` field will be mapped to the key `"id"`.

### 4. Zero Value Initialization

Go guarantees every variable is initialized to a useful **zero value** when declared. This reduces the need for constructors.

|**Type**|**Zero Value**|
|---|---|
|`int`, `float`|`0`|
|`bool`|`false`|
|`string`|`""` (empty string)|
|`pointer`, `slice`, `map`|`nil`|

**Idiomatic:** Rely on the zero value and initialize fields _selectively_ later.

Go

```
var u User // u is ready to use: u.ID = 0, u.Name = ""
```

### 5. Receiver Pointers vs. Values in Methods

When defining a method on a struct (Chapter 6), decide if the receiver should be a value (`T`) or a pointer (`*T`).

- **Use a Pointer Receiver (`func (t *T) Method(...)`)** if:
    
    - The method modifies the fields of the struct.
        
    - The struct is large (to avoid copying the entire struct).
        
- **Use a Value Receiver (`func (t T) Method(...)`)** if:
    
    - The method only _reads_ the struct's fields.
        

---

### ðŸ”— Reference

- **Effective Go:** The definitive guide to writing clear, idiomatic Go: [https://go.dev/doc/effective_go](https://go.dev/doc/effective_go)
    
- **Go Wiki - CodeReviewComments:** A collection of common best practices: [https://github.com/golang/go/wiki/CodeReviewComments](https://github.com/golang/go/wiki/CodeReviewComments)