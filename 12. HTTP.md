## üåê Chapter 12: Working with HTTP (Building a Web Server)

Go's standard library is incredibly powerful, and nowhere is this more apparent than its built-in networking capabilities. You can build a complete, high-performance web server without any external dependencies.

### 1. The Standard Library (`net/http`)

All essential HTTP client and server functionality is handled by the `net/http` package.

#### Example: A Simple "Hello World" Server

This code sets up a server that listens on port `8080` and routes all requests (`/`) to the `handler` function.

Go

```
package main

import (
    "fmt"
    "log"
    "net/http"
)

// The handler function takes two standard arguments:
// w: http.ResponseWriter (where you write the response)
// r: *http.Request (the incoming request details)
func handler(w http.ResponseWriter, r *http.Request) {
    // 1. Write the HTTP status code (default is 200 OK)
    w.WriteHeader(http.StatusOK) 
    
    // 2. Write the response body
    fmt.Fprintf(w, "Hello, Go Web! You requested: %s", r.URL.Path)
}

func main() {
    // 1. Define the handler function for all requests ('/')
    http.HandleFunc("/", handler)

    // 2. Start the server on port 8080. This call blocks (runs forever).
    fmt.Println("Server starting on :8080...")
    
    // log.Fatal is used here because an error starting the server is critical
    log.Fatal(http.ListenAndServe(":8080", nil))
}
```

**Run it:**

1. Save the code (e.g., as `server.go`).
    
2. Run: `go run server.go`
    
3. Visit `http://localhost:8080/test` in your browser.
    

**Key Components:**

- **`http.HandleFunc`**: Registers a function (`handler`) to handle requests for a specific path (`/`).
    
- **`http.ListenAndServe`**: Starts the HTTP server on a specified address (`:8080`). The second argument (`nil`) tells the server to use the default request multiplexer (router).
    

---

### 2. Handling Different HTTP Methods (Routing)

The `*http.Request` object contains the `Method` field, allowing you to easily handle different HTTP verbs (GET, POST, PUT, DELETE) within a single handler.

Go

```
func apiHandler(w http.ResponseWriter, r *http.Request) {
    switch r.Method {
    case "GET":
        // Handle fetching data
        fmt.Fprintf(w, "GET request received.")
    case "POST":
        // Handle submitting new data
        fmt.Fprintf(w, "POST request received.")
        // You would typically read data from r.Body here
    default:
        // Use http.Error for standard error responses
        http.Error(w, "Method not supported.", http.StatusMethodNotAllowed)
    }
}
```

### 3. Reading Request Data

You can access URL parameters, headers, and the request body easily:

|**Component**|**How to Access**|**Purpose**|
|---|---|---|
|**URL Path**|`r.URL.Path`|The path part of the URL (e.g., `/users/1`)|
|**Query Params**|`r.URL.Query().Get("id")`|Accesses `?id=value` in the URL|
|**Headers**|`r.Header.Get("Content-Type")`|Accesses request headers|
|**Body**|`r.Body`|The stream containing POST/PUT data (requires reading)|

---

### üîó Reference

- **Go Documentation - `net/http`:** [https://go.dev/pkg/net/http/](https://go.dev/pkg/net/http/)
    
- **Go Tour - HTTP Clients and Servers:** The official tour provides a brief overview.